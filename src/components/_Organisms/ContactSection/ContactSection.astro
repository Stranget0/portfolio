---
import SectionClip from "@components/SectionClip.astro";
import Input from "@components/Input/Input.astro";
import TextArea from "@components/Input/TextArea.astro";
import Button from "@components/Button/Button.astro";
import ContactInputContainer from "./ContactInputContainer.astro";
import AppearingLine from "@components/AppearingText/AppearingLine.astro";
import waypoints from "@components/ThreeScene/modules/waypoints/waypointsServerApi";
import { forceFocusViewAttrObj } from "@plugins/forceFocusView/constants";
import { mainpageTabs } from "src/constants";
import AnimatedText from "@/components/AnimatedText.astro";
import { classInView } from "@/plugins/classInView/serverUtils";
import { useTranslations } from "@/i18n/utils";

const t = useTranslations(Astro.url);

const waypointsData = {
	...waypoints
		.foxWaypointCameraSpatial(3, 1.5, -0.421)
		.addBreakpoint(1024, 2, 1.5, -0.421)
		.waypoint(),
	...waypoints
		.foxWaypointTarget(0, -1, 0)
		.addBreakpoint(1024, 1, -0.5, 0)
		.waypoint(),
	...waypoints.foxWaypointStiffness(3, 4).waypoint(),
};
---

<section
	id={mainpageTabs.contact.id}
	class="min-h-100vh text-primary-50 relative text-right before:(pseudo-full bg-primary-950 -z-3)"
	data-static-h="100vh"
	data-static-h-type="min"
	{...waypointsData}
	{...forceFocusViewAttrObj}
>
	<SectionClip class="absolute inset-0">
		<AppearingLine
			as="h2"
			text={t("common.contact-me")}
			class="relative ml-auto mt-4 mr-4 top-4 lg:(mr-16 top-16) w-min z-1000 text-subtitle-1 solid-text-shadow"
			animatedOnView
		/>
		<div class="absolute inset-0 -top-100vh important:-top-100svh">
			<div
				class="sticky section px-16 pb-4 top-0 h-screen important:h-100svh justify-end items-center lg:items-end"
			>
				<ContactInputContainer
					class="motion-safe:transition-300"
					{...classInView("opacity-0 scale-0", "", 0.5)}
				>
					<Input
						name="name"
						id="contact-name"
						label={t("input.name")}
						wrapperClass="bg-primary-950"
						required
						autocomplete
					/>
					<Input
						id="contact-email"
						name="email"
						label={t("input.email")}
						type="email"
						wrapperClass="bg-primary-950"
						required
						autocomplete
					/>
					<TextArea
						id="contact-message"
						label={t("input.message")}
						name="message"
						wrapperClass="bg-primary-950 max-h-20 md:max-h-60"
						required
						minlength={10}
						maxlength={1000}
					/>
					<Button as="button" type="submit" visualType="outline">
						<AnimatedText word={t("input.submit")} />
					</Button>
				</ContactInputContainer>
			</div>
		</div>
	</SectionClip>
</section>
