---
import SectionClip from "@components/SectionClip.astro";
import SectionFixed from "@components/SectionFixed.astro";
import Input from "@components/Input/Input.astro";
import TextArea from "@components/Input/TextArea.astro";
import Button from "@components/Button/Button.astro";
import ContactInputContainer from "./ContactInputContainer.astro";
import AppearingLine from "@components/AppearingText/AppearingLine.astro";
import waypoints from "@components/ThreeScene/modules/waypoints/waypointsServerApi";
import { forceFocusViewAttrObj } from "@plugins/forceFocusView/constants";
import { mainpageTabs } from "src/constants";
import AnimatedText from "@/components/AnimatedText.astro";
import { scrollVelocityTransform } from "@/plugins/scrollVelocityTransform/serverUtils";
import { classInView } from "@/plugins/classInView/serverUtils";

const md = 768;
const waypointsData = {
	...waypoints
		.foxWaypointCameraSpatial(3, 1.5, -0.421)
		.addBreakpoint(md, 2, 1.5, -0.421)
		.waypoint(),
	...waypoints
		.foxWaypointTarget(0, -1, 0)
		.addBreakpoint(md, 1, -0.5, 0)
		.waypoint(),
	...waypoints.foxWaypointStiffness(3, 4).waypoint(),
};
---

<section
	id={mainpageTabs.contact.id}
	class="min-h-screen text-primary-50 relative text-right before:(pseudo-full bg-primary-950 -z-3)"
	data-static-h="100vh"
	data-static-h-type="min"
	{...waypointsData}
	{...forceFocusViewAttrObj}
>
	<SectionClip class="absolute inset-0">
		<SectionFixed
			class="section pb-4 inset-4 justify-end items-center md:items-end motion-safe:transition"
			{...scrollVelocityTransform(5)}
		>
			<ContactInputContainer {...classInView("opacity-0 scale-0", "transition-300", .25)}>
				<AppearingLine
					as="h2"
					text="Contact me!"
					class="text-subtitle-1"
					animatedOnView
				/>
				<Input
					name="name"
					id="contact-name"
					label="name"
					wrapperClass="bg-primary-950"
					required
				/>
				<Input
					id="contact-email"
					name="email"
					label="email"
					type="email"
					wrapperClass="bg-primary-950"
					required
				/>
				<TextArea
					id="contact-message"
					label="message"
					name="message"
					wrapperClass="bg-primary-950 max-h-20 md:max-h-60"
					required
					minlength={10}
					maxlength={1000}
				/>
				<Button as="button" type="submit" visualType="outline">
					<AnimatedText word="Submit" />
				</Button>
			</ContactInputContainer>
		</SectionFixed>
	</SectionClip>
</section>
