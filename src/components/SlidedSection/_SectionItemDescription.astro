---
import { classInView } from "@/plugins/classInView/serverUtils";
import AppearingLine from "@components/AppearingText/AppearingLine.astro";
import SectionFixed from "@components/SectionFixed.astro";
import type { HTMLAttributes } from "astro/types";

interface Props extends HTMLAttributes<"div"> {
	text?: string;
}

const { text, class: className, ...other } = Astro.props;
const descClass = ["text-body prose", className];

const referenceData = classInView("reference-hidden","reference-visible")
---

<div
	class="w-full my-125 h-50"
	{...referenceData}
>
</div>
<SectionFixed
	class="description z-200 text-balance flex-col-center justify-center items-center prose h-max m-auto text-center max-w-full right-4 left-4 bottom-4 top-0 motion-safe:transition-600 lg:(right-36 left-36 bottom-8)"
>
	<!-- TODO: FIX TYPE -->{
		text ? (
			text
				.split("\n")
				.map((t) => (
					<AppearingLine
						{...(other as any)}
						text={t}
						class={descClass}
						group="description"
					/>
				))
		) : (
			<div class:list={descClass}>
				<slot />
			</div>
		)
	}
</SectionFixed>

<style>
	.reference-hidden + .description {
		opacity: 0;
		transform: translateY(50%) scale(0);
	} 
	.reference-visible + .description {
		opacity: 1;
		transform: translateY(50%) scale(1);
	} 
</style>